<!DOCTYPE html>
<html>
<body style="margin:0">
<audio id="bgMusic" autoplay loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const music = document.getElementById("bgMusic");
music.volume = 0.4;

// Fade out function (we will trigger this later)
window.addEventListener("message", function(event) {
  if (event.data === "fadeOut") {
    let fade = setInterval(() => {
      if (music.volume > 0.02) {
        music.volume -= 0.02;
      } else {
        music.volume = 0;
        clearInterval(fade);
      }
    }, 200);
  }
});
</script>
</body>
</html>
